/*! d3.chart - v0.2.1
 *  License: MIT Expat
 *  Date: 2014-06-28
 */
(function(t,e){"use strict";"function"==typeof t.define&&t.define.amd?define(["d3"],function(n){e(t,n)}):e(t,t.d3)})(this,function(t,e){"use strict";function n(t){var e,n,r,i;if(!t)return t;for(n=arguments.length,e=1;n>e;e++)if(r=arguments[e])for(i in r)t[i]=r[i];return t}var r=Object.hasOwnProperty,i=function(t,e){if(!t)throw Error("[d3.chart] "+e)};i(e,"d3.js is required"),i("string"==typeof e.version&&e.version.match(/^3/),"d3.js version 3 is required");var a=/^(enter|update|merge|exit)(:transition)?$/,s=function(t){i(t,"Layers must be initialized with a base."),this._base=t,this._handlers={}};s.prototype.dataBind=function(){i(!1,"Layers must specify a `dataBind` method.")},s.prototype.insert=function(){i(!1,"Layers must specify an `insert` method.")},s.prototype.remove=function(){this.remove()},s.prototype.on=function(t,e,n){return n=n||{},i(a.test(t),"Unrecognized lifecycle event name specified to `Layer#on`: '"+t+"'."),t in this._handlers||(this._handlers[t]=[]),this._handlers[t].push({callback:e,chart:n.chart||null}),this._base},s.prototype.off=function(t,e){var n,r=this._handlers[t];if(i(a.test(t),"Unrecognized lifecycle event name specified to `Layer#off`: '"+t+"'."),!r)return this._base;if(1===arguments.length)return r.length=0,this._base;for(n=r.length-1;n>-1;--n)r[n].callback===e&&r.splice(n,1);return this._base},s.prototype.draw=function(t){var n,r,a,s,o,h,c,l,u;n=this.dataBind.call(this._base,t),i(n&&n.call===e.selection.prototype.call,"Invalid selection defined by `Layer#dataBind` method."),i(n.enter,"Layer selection not properly bound."),r=n.enter(),r._chart=this._base._chart,a=[{name:"update",selection:n},{name:"enter",selection:r,method:this.insert},{name:"merge",selection:n},{name:"exit",selection:n,method:n.exit}];for(var f=0,p=a.length;p>f;++f)if(c=a[f].name,s=a[f].selection,o=a[f].method,"function"==typeof o&&(s=o.call(s)),!s.empty()){if(i(s&&s.call===e.selection.prototype.call,"Invalid selection defined for '"+c+"' lifecycle event."),h=this._handlers[c])for(l=0,u=h.length;u>l;++l)s._chart=h[l].chart||this._base._chart,s.call(h[l].callback);if(h=this._handlers[c+":transition"],h&&h.length)for(s=s.transition(),l=0,u=h.length;u>l;++l)s._chart=h[l].chart||this._base._chart,s.call(h[l].callback)}this.remove.call(s)},e.selection.prototype.layer=function(t){var e,n=new s(this);if(n.dataBind=t.dataBind,n.insert=t.insert,"events"in t)for(e in t.events)n.on(e,t.events[e]);return this.on=function(){return n.on.apply(n,arguments)},this.off=function(){return n.off.apply(n,arguments)},this.draw=function(){return n.draw.apply(n,arguments)},this};var o=function(t,e){var n=this.constructor,i=n.__super__;i&&o.call(i,t,e),r.call(n.prototype,"initialize")&&this.initialize.apply(t,e)},h=function(t,e){var n=this.constructor,i=n.__super__;return this===t&&r.call(this,"transform")&&(e=this.transform(e)),r.call(n.prototype,"transform")&&(e=n.prototype.transform.call(t,e)),i&&(e=h.call(i,t,e)),e},c=function(t,e){this.base=t,this._layers={},this._attached={},this._events={},e&&e.transform&&(this.transform=e.transform),o.call(this,this,[e])};c.prototype.initialize=function(){},c.prototype.unlayer=function(t){var e=this.layer(t);return delete this._layers[t],delete e._chart,e},c.prototype.layer=function(t,e,n){var r;if(1===arguments.length)return this._layers[t];if(2===arguments.length){if("function"==typeof e.draw)return e._chart=this,this._layers[t]=e,this._layers[t];i(!1,"When reattaching a layer, the second argument must be a d3.chart layer")}return r=e.layer(n),this._layers[t]=r,e._chart=this,r},c.prototype.attach=function(t,e){return 1===arguments.length?this._attached[t]:(this._attached[t]=e,e)},c.prototype.transform=function(t){return t},c.prototype.draw=function(t){var e,n,r;t=h.call(this,this,t);for(e in this._layers)this._layers[e].draw(t);for(n in this._attached)r=this.demux?this.demux(n,t):t,this._attached[n].draw(r)},c.prototype.on=function(t,e,n){var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n||this,_chart:this}),this},c.prototype.once=function(t,e,n){var r=this,i=function(){r.off(t,i),e.apply(this,arguments)};return this.on(t,i,n)},c.prototype.off=function(t,e,n){var r,i,a,s,o,h;if(0===arguments.length){for(t in this._events)this._events[t].length=0;return this}if(1===arguments.length)return a=this._events[t],a&&(a.length=0),this;for(r=t?[t]:Object.keys(this._events),o=0;r.length>o;o++)for(i=r[o],a=this._events[i],h=a.length;h--;)s=a[h],(e&&e===s.callback||n&&n===s.context)&&a.splice(h,1);return this},c.prototype.trigger=function(t){var e,n,r=Array.prototype.slice.call(arguments,1),i=this._events[t];if(void 0!==i)for(e=0;i.length>e;e++)n=i[e],n.callback.apply(n.context,r);return this},c.extend=function(t,e,i){var a,s=this;a=e&&r.call(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},n(a,s,i);var o=function(){this.constructor=a};return o.prototype=s.prototype,a.prototype=new o,e&&n(a.prototype,e),a.__super__=s.prototype,c[t]=a,a},e.chart=function(t){return 0===arguments.length?c:1===arguments.length?c[t]:c.extend.apply(c,arguments)},e.selection.prototype.chart=function(t,e){if(0===arguments.length)return this._chart;var n=c[t];return i(n,"No chart registered with name '"+t+"'"),new n(this,e)},e.selection.enter.prototype.chart=function(){return this._chart},e.transition.prototype.chart=e.selection.enter.prototype.chart});
//@ sourceMappingURL=d3.chart.min.map